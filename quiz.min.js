const express=require("express"),app=express();var server=require("http").createServer(app);const bodyParser=require("body-parser"),{Pool:Pool}=require("pg");var nodemailer=require("nodemailer");let pool=new Pool({user:"postgres",password:"password",host:"localhost",port:5432,database:"realtime"});var regcompleted=!1,regagain=!1,isntreg=!1,passwrong=!1,userpass=!1,passpass=!1,passsent=!1,newdetails=!1;const port=8080;app.use(express.json()),app.use(bodyParser.urlencoded({extended:!0}));let date_ob=new Date,date=("0"+date_ob.getDate()).slice(-2),month=("0"+(date_ob.getMonth()+1)).slice(-2),year=date_ob.getFullYear();var userDate=year+"-"+month+"-"+date;function shuffle(e){for(var n,t=e.length;0!==t;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e}app.get("/",(e,n)=>{try{list=[],userChoice=[],firstchoice=[],correctchoice=[],secondchoice=[],arr=[],counts=0,userEmail="",pool.connect(async(e,t,o)=>{var a=(await t.query("SELECT nickname, MAX(attemptnumber) as maxattempt FROM leaderboard \n        GROUP BY nickname ORDER BY maxattempt DESC")).rows.length;let r=await t.query("SELECT nickname, ROUND(avg(improvement)) as avgimprovement \n        FROM leaderboard \n        GROUP BY nickname\n        ORDER BY avgimprovement DESC");var s="";for(i=0;i<a;i++)s+='<tr style="text-align: center">',s+="<td><b>"+(i+1)+"</b></td>",s+="<td><b>"+r.rows[i].nickname+"</b></td>",s+="<td><b>"+r.rows[i].avgimprovement+"%</b></td>",s+="</tr>";t.release(),n.send(`<!DOCTYPE html>\n        <html lang="en">\n        <head>\n            <meta charset="UTF-8">\n            <meta http-equiv="X-UA-Compatible" content="IE=edge">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>Real-Time Quiz App</title>\n            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"\n            crossorigin="anonymous">\n            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"><\/script>\n            <script>\n\n            var nowreg = "You Are Now Registered";\n            var alreadyreg = "You Are Registered";\n            var notreg = "You Are Not Registered";\n            var wrongcode = "Incorrect Password";\n            var userwrong = "Incorrect Password <br> Login Again";\n            var passemailed = "Password Sent";\n            var changedetails = "Details Changed <br> Login Again";\n\n            <\/script>\n            <style>\n\n                h1 {\n                    font-family: Fantasy;\n                }\n                body {\n                    text-align: center;\n                    background: powderblue;\n                }\n\n                table {\n                    border-collapse: collapse;\n                    border: none !important;\n                    \n                }\n            \n                h2 {\n                    text-align: center;   \n                    color: white; \n                    font-family: Fantasy;\n                }\n\n                th {\n                    text-align: center;\n                }\n\n                form {\n                    display: inline-block;\n                }\n\n                .achievements-wrapper { \n                    height: 100%;\n                    width: 100%; \n                    overflow-y: auto;\n                    text-align: center;\n                    position: fixed;\n                }\n\n                input{\n                    text-align:center;\n                 }\n\n                 th {\n                    position: sticky;\n                    top: 0px;  \n                    background: white;\n                    color: black;\n                  }\n                  \n                  /* Add a black background color to the top navigation */\n                    .topnav {\n                    background-color: #333;\n                    overflow: hidden;\n                    }\n\n                    /* Style the links inside the navigation bar */\n                    .topnav a {\n                    float: left;\n                    color: #f2f2f2;\n                    text-align: center;\n                    padding: 24px 5%;\n                    text-decoration: none;\n                    font-size: 17px;\n                    }\n\n                    /* Add a color to the active/current link */\n                    .topnav a.active {\n                    background-color: #04AA6D;\n                    color: white;\n                    }\n            </style>\n        </head>\n        <body>\n        <div class="topnav">\n            <a href="/" onclick='showHome();' style="width: 100%; background-color: black;"><h2>&#9200 RealTime Quiz</h2></a>\n            <a id="home1" href="/" onclick='showHome();' class="active"  style="width: 33%;">Home</a>\n            <a id="rankings1" href="#rankings" onclick="showRankings();" style="width: 33%;">Rankings</a>\n            <a id="about1" href="#about" onclick="showAbout();" style="width: 33%;">About</a>\n        </div>\n                    <div id="home" style="padding-top: 20px;">\n                        <h3 id="homeMessage">Enter Details to Play!</h3>\n                        <form action="/info/add" method="POST"><br>\n                            <p id="manyemail" style="color: red; display:none;"><b>Max Characters 40</b></p>\n                            <input type="email" name="email" id="email" maxlength="40" placeholder='Enter Email Address' style="margin-left: 10px font-size: 18pt; height: 30px; width:260px;" required>\n                            <br><br> \n                            <p id="manypassword" style="color: red; display:none;"><b>Max Characters 20</b></p>\n                            <input type="password" name="password" id="password" maxlength="20" placeholder='Enter Your Password' style="margin-left: 5px font-size: 18pt; height: 30px; width:260px;" required><br><br>\n                            \n                            <div style="width:250px;" align="center">\n                                <button type="submit" class="btn btn-primary btn-block" style="font-size: 11pt; width:260px; height: 34px;">Login</button>\n                            </div><br>                            \n                        </form><br>\n                        <form action="/registration" method="GET">\n                        <div style="width:260px; align: center;">\n                                <button type="submit" class="btn btn-primary btn-block" style="font-size: 11pt; width:260px; height: 34px;">Registration</button>\n                            </div><br>  \n                        </form><br>\n                        <form action="/forgotten/password" method="GET">\n                        <div style="width:260px; align: center;">\n                                <button type="submit" class="btn btn-primary btn-block" style="font-size: 11pt; width:260px; height: 34px;">Forgotten Password</button>\n                            </div><br>  \n                        </form>\n                    </div>\n            <div id="rankings" class="span3 achievements-wrapper" style="display:none;">\n                \n                        <table class="table table-striped table-light">\n                        <th colspan="1" class="table-grey"><h4>POS</h4></th>\n                        <th colspan="1" class="table-grey"><h4>NAME</h4></th>\n                        <th colspan="1" class="table-grey"><h4>%IMP</h4></th>\n                            <tbody>\n                                ${s}\n                            </tbody>\n                        </table>  \n                    </div>\n\n                    <div class="achievements-wrapper" id="about" style="display:none;"><br>\n                    <h5 style="text-align: left; margin-left:10px;margin-right:10px;">Who Can Benefit</h5>\n                    <p style="text-align: left;margin-left:10px;margin-right:10px;">This App has been developed to assist in memory/brain training\n                    to help improve cognitive function. The focus of the quiz is on users improvement in memory recall over a number of attempts at the quiz,\n                     rather than the number of correct answers selected on their first attempt. The ranking system reflects this focus.</p>\n                    <h5 style="text-align: left;margin-left:10px;margin-right:10px;">How it Works</h5>\n                    <p style="text-align: left;margin-left:10px;margin-right:10px;">Once registered you will see a list of questions with the correct answers.\n                    You will have a short time to remember as many answers as possible before the quiz begins.\n                    In the user profile section functionality is included for users to track their progress and the progress of any friends who also play the quiz.\n                    </p>\n                    </div>\n                    \n        </body>\n        <script>\n                    if (${regcompleted} == true){\n                        document.getElementById("homeMessage").innerHTML = nowreg;  \n                    }\n                    if (${regagain} == true){\n                        document.getElementById("homeMessage").innerHTML = alreadyreg;   \n                    }\n                    if (${isntreg} == true){\n                        document.getElementById("homeMessage").innerHTML = notreg;\n                    }\n                    if (${passwrong} == true){\n                        document.getElementById("homeMessage").innerHTML = wrongcode;\n                    }\n\n                    if (${userpass} == true || ${passpass} == true){\n                        document.getElementById("homeMessage").innerHTML = userwrong;\n                    }\n\n                    if (${passsent} == true){\n                        document.getElementById("homeMessage").innerHTML = passemailed;\n                    }\n\n                    if (${newdetails} == true){\n                        document.getElementById("homeMessage").innerHTML = changedetails;\n                    }\n\n                    $("#email").on('input', function() {\n                        if ($(this).val().length >= 40) {\n                            document.getElementById("manyemail").style.display = "block";\n                        } else{\n                            document.getElementById("manyemail").style.display = "none";\n                        }\n                    });\n\n                    var $input = $('input')\n                    $input.keyup(function(e) {\n                        var max = 40;\n                        if ($input.val().length > max) {\n                            $input.val($input.val().substr(0, max));\n                        }\n                    });\n\n                    $("#password").on('input', function() {\n                        if ($(this).val().length >= 20) {\n                            document.getElementById("manypassword").style.display = "block";\n                        } else{\n                            document.getElementById("manypassword").style.display = "none";\n                        }\n                    });\n\n                    function showHome(){\n                        document.getElementById("home").style.display = "block";\n                        document.getElementById("home1").className = "active";\n                        document.getElementById("rankings").style.display = "none";\n                        document.getElementById("rankings1").className = "";\n                        document.getElementById("about").style.display = "none";\n                        document.getElementById("about1").className = "";\n                    }\n                    function showRankings(){\n                        document.getElementById("home").style.display = "none";\n                        document.getElementById("home1").className = "";\n                        document.getElementById("rankings").style.display = "block";\n                        document.getElementById("rankings1").className = "active";\n                        document.getElementById("about").style.display = "none";\n                        document.getElementById("about1").className = "";\n                    }\n                    function showAbout(){\n                        document.getElementById("home").style.display = "none";\n                        document.getElementById("home1").className = "";\n                        document.getElementById("rankings").style.display = "none";\n                        document.getElementById("rankings1").className = "";\n                        document.getElementById("about").style.display = "block";\n                        document.getElementById("about1").className = "active";\n                    }\n        <\/script>\n        </html>`),regagain=!1,regcompleted=!1,isntreg=!1,passwrong=!1,userpass=!1,passpass=!1,newdetails=!1})}catch(e){console.log(e)}}),app.get("/registration",(e,n)=>{try{n.send('<!DOCTYPE html>\n        <html lang="en">\n        <head>\n            <meta charset="UTF-8">\n            <meta http-equiv="X-UA-Compatible" content="IE=edge">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>Real-Time Quiz App</title>\n            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"\n            crossorigin="anonymous">\n            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"><\/script>\n            \n            <style>\n\n                body {\n                    text-align: center;\n                    background-color: powderblue;\n                }\n\n                form {\n                    display: inline-block;\n                }\n\n                h2 {\n                    text-align: center;   \n                    color: white; \n                    font-family: Fantasy;\n                }\n\n                input{\n                    text-align:center;\n                 }\n\n                 .topnav {\n                 background-color: #333;\n                 overflow: hidden;\n                 position: sticky;\n                 }\n\n                 .topnav a {\n                 float: left;\n                 color: #f2f2f2;\n                 text-align: center;\n                 padding: 24px 5%;\n                 text-decoration: none;\n                 font-size: 17px;\n                 }\n\n                 .topnav a.active {\n                 background-color: #04AA6D;\n                 color: white;\n                 width: 25%;\n                 }\n\n                 .login  {\n                    background-color: #0057fc;\n                    color: white;   \n                }\n\n            </style>\n        </head>\n        <body>\n        <div class="topnav fixed-top">\n            <a href="/" style="width: 100%; background-color: black;"><h2>&#9200 REAL-TIME QUIZ</h2></a>\n        </div>\n        <div id="disclaimer" style="margin-left: 10%; margin-right: 10%;  text-align: justify;text-justify: inter-word; display:none;">\n            <h3 style="margin-top: 3%; text-align: center;">DATA PROTECTION</h3><br>\n            By pressing the Submit Button you agree to your data being used for the purpose of my university project. This app has\n            been designed to eventually help people that have difficulty with their memory. Your\n            user name, password, email address and the record of your attempts at this quiz will be stored in a database. Your data will be\n            used to analyse how effective the application is at improving memory, and will only be used to prepare a\n            university project report and for no other purpose. Personal information such as your password, name and email address will be \n            anonymised and not linked to you directly in any way when referred to in my research report. No marketing agencies, governing bodies \n            or any other outside organisation will be provided access to your data. The only people who have access to your data will be the \n            person directly involved in the research for this university project and noone else. Your participation in this project is entirely \n            voluntary, and you can choose to be removed from the database and project report by emailing me at cy1yates@gmail.com by 15 August 2021.\n            \n        </div>\n            <div id= "form" style="padding-top: 1%;">\n                        <div id="form1">\n                        <h4>Step 1 - Enter Details</h4>\n                        </div><br>\n                        <form action="/adduser" method="POST">\n                            <div>\n                            <label for="email" id="manyemail" style="color: red; display: none;"><b>Max 40 Email Characters</b></label>\n                            </div>\n                            <div id="form2">\n                            <input type="email" name="email" id="email" maxlength="40" placeholder=\'Enter Email Address\' style="margin-left: 10px \n                            font-size: 18pt; height: 30px; width:260px;" required><br>\n                            </div>\n                            <div>\n                            <label for="nickname" id="manynickname" style="color: red; display: none; margin-bottom: -10px;"><b>Max 14 Name Characters</b></label>\n                            </div>\n                            <div id="form3">\n                            <input type="text" name="nickname" id="nickname" maxlength="14" placeholder=\'Enter Your Name\' style="margin-left: 10px \n                            font-size: 18pt; height: 30px; width:260px;margin-top: 5%;" required><br> \n                            </div>\n                            <div>\n                            <label for="password" id="manypassword" style="color: red;display: none;"><b>Max 20 Password Characters</b></label>\n                            </div>\n                            <div id="form4">\n                            <input type="password" name="password" id="password" maxlength="20" placeholder=\'Enter Your Password\' style="margin-left: \n                            5px font-size: 18pt; height: 30px; width:260px;margin-top: 5%;" required><br>\n                            </div>\n                            <div id="form5">\n                            <input type="password" name="password_confirm" id="password_confirm" maxlength="20" placeholder=\'Re-Enter Your Password\' \n                            style="margin-left: 5px font-size: 18pt; height: 30px; width:260px;margin-top: 5%;" \n                            oninput="check(this)" required><br>\n                            </div>\n                            <script language=\'javascript\' type=\'text/javascript\'>\n                                function check(input) {\n                                    if (input.value != document.getElementById(\'password\').value) {\n                                        input.setCustomValidity(\'Password Must be Matching.\');\n                                    } else {\n                                        // input is valid -- reset the error message\n                                        input.setCustomValidity(\'\');\n                                    }\n                                }\n                            <\/script>\n                            <div id="button" class="row justify-content-center" style="display:none;">\n                                <button for="form" type="submit" class="btn btn-primary btn-block" style="font-size: 18pt; width:300px;">Agree and Register</button>\n                            </div><br>    \n                                     \n                        </form>\n                    </div>\n                    <div id="button2" class="row justify-content-center">\n                        <button type="submit" class="btn btn-primary btn-block" onclick="step2();" style="height: 12%;font-size: 18pt; width:100%;position: \n                        absolute; bottom:0;margin-right:20%;margin-left:20%;">Go to Step 2</button>\n                    </div><br>                            \n                        \n              <script>\n              var $input = $(\'input\')\n                    $input.keyup(function(e) {\n                        var max = 40;\n                        if ($input.val().length > max) {\n                            $input.val($input.val().substr(0, max));\n                        }\n                    });\n\n              $("#email").on(\'input\', function() {\n                if ($(this).val().length >= 40) {\n                    document.getElementById("manyemail").style.display = "block";\n                } else{\n                    document.getElementById("manyemail").style.display = "none";\n                }\n            });\n   \n            $("#password").on(\'input\', function() {\n                if ($(this).val().length >= 20) {\n                    document.getElementById("manypassword").style.display = "block";\n                } else{\n                    document.getElementById("manypassword").style.display = "none";\n                }\n            });\n\n            $("#nickname").on(\'input\', function() {\n                if ($(this).val().length >= 14) {\n                    document.getElementById("manynickname").style.display = "block";\n                } else{\n                    document.getElementById("manynickname").style.display = "none";\n                }\n            });\n\n            function step2(){\n                document.getElementById("form1").style.display = "none";\n                document.getElementById("form2").style.display = "none";\n                document.getElementById("form3").style.display = "none";\n                document.getElementById("form4").style.display = "none";\n                document.getElementById("form5").style.display = "none";\n                document.getElementById("button2").style.display = "none";\n                document.getElementById("disclaimer").style.display = "block";\n                document.getElementById("button").style.display = "block";\n            }\n              <\/script>\n        </body>\n        </html>')}catch(e){console.log(e)}});var register="";app.post("/adduser",(e,n)=>{try{pool.connect(async(t,o,a)=>{let r=await o.query("SELECT name, useremail from users");for(registeragain=!1,nickName=e.body.nickname,i=0;i<r.rows.length;i++)e.body.email==r.rows[i].useremail&&(registeragain=!0),e.body.nickname==r.rows[i].name&&(registeragain=!0);if(1==registeragain)o.release(),regagain=!0,n.redirect("/");else{await o.query("insert into users (useremail, name, password) values ($1, $2, $3)",[e.body.email,e.body.nickname,e.body.password]);o.release(),regcompleted=!0,n.redirect("/")}}),register=""}catch(e){console.log(e)}}),app.get("/forgotten/password",(e,n)=>{try{n.send('<!DOCTYPE html>\n        <html lang="en">\n        <head>\n            <meta charset="UTF-8">\n            <meta http-equiv="X-UA-Compatible" content="IE=edge">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>Real-Time Quiz App</title>\n            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"\n            crossorigin="anonymous">\n            <script src=\'quiz.js\'><\/script>\n        \n            <style>\n                body {\n                    text-align: center;\n                    background: powderblue;\n                }\n\n                form {\n                    display: inline-block;\n                }\n\n                h1 {\n                    text-align: center;    \n                }\n\n                input{\n                    text-align:center;\n                 }\n                    .topnav {\n                    background-color: #333;\n                    overflow: hidden;\n                    }\n\n                    .topnav a {\n                    float: left;\n                    color: #f2f2f2;\n                    text-align: center;\n                    padding: 24px 5%;\n                    text-decoration: none;\n                    font-size: 17px;\n                    }\n\n                    .topnav a.active {\n                    background-color: #04AA6D;\n                    color: white;\n                    }\n\n                    .login  {\n                        background-color: #0057fc;\n                        color: white;   \n                    }\n            </style>\n        </head>\n        <body>\n        <div class="topnav">\n            <a href="/" onclick=\'showHome();\' style="width: 100%; background-color: black;"><h1>&#9200 RealTime Quiz</h1></a>\n        </div>\n            <div style="padding-top: 5%;">\n                   \n                        <h4>Get Password Reminder</h4><br>\n                        <form action="/get/password" method="POST">\n\n                            <input type="email" name="email" id="email" maxlength="40" placeholder=\'Enter Email Address\' style="margin-left: 10px font-size: 18pt; height: 40px; width:260px;" required><br><br> \n                            <div style="width:250px;" align="center">\n                                <button type="submit" class="btn btn-block login" style="font-size: 18pt; width:260px;">Retrieve Password</button>\n                            </div><br>                            \n                        </form>\n                    </div>\n        </body>\n        </html>')}catch(e){console.log(e)}}),app.post("/get/password",async(e,n)=>{try{pool.connect(async(t,o,i)=>{let a=await o.query(`select password from users where useremail = '${e.body.email}'`);if(a.rows.length>0){var r=nodemailer.createTransport({service:"outlook",auth:{user:"real_time_quiz@outlook.com",pass:"Realtimequiz"}}),s={from:"real_time_quiz@outlook.com",to:`${e.body.email}`,subject:"Forgotten Password",text:`Your Password is: ${a.rows[0].password}`};r.sendMail(s,function(e,n){e&&console.log(e)}),o.release(),passsent=!0,n.redirect("/")}})}catch(e){console.log(e)}}),app.post("/info/add",async(e,n)=>{nickName="",userEmail="";var t=0,o=!1;try{pool.connect(async(a,r,s)=>{let l=await r.query("select * from users");for(i=0;i<l.rows.length;i++){if(l.rows[i].useremail==e.body.email&&l.rows[i].password==e.body.password){t=0,o=!0;break}if(l.rows[i].useremail==e.body.email&&l.rows[i].password!=e.body.password){t=0,o=!1;break}t=1}let c=await r.query(`select * from users, leaderboard where leaderboard.nickname\n            = users.name and users.useremail = '${e.body.email}'`);1==t?(r.release(),isntreg=!0,n.redirect("/")):0==o?(r.release(),passwrong=!0,n.redirect("/")):c.rows.length>0?(nickName+=c.rows[0].name,userEmail+=c.rows[0].useremail,r.release(),n.redirect("/user/profile")):pool.connect(async(e,t,o)=>{var i=await t.query("select * from users"),a=i.rows.length;nickName+=i.rows[a-1].name,userEmail+=i.rows[a-1].useremail,t.release(),n.redirect("/user/profile")})})}catch(e){console.log(e)}}),app.get("/user/profile",async(e,n)=>{try{list=[],userChoice=[],firstchoice=[],correctchoice=[],secondchoice=[],arr=[],counts=0;var t="";pool.connect(async(e,o,a)=>{let r=await o.query(`select * from leaderboard where nickname = '${nickName}' order by attemptnumber asc`);var s="";for(i=0;i<r.rows.length;i++)s+="<tr>",s+='<td style="width: 35%"><b>Attempt '+r.rows[i].attemptnumber+"</b></td>",s+='<td style="width: 35%"><b>'+r.rows[i].date+"</b></td>",s+='<td style="width: 35%"><b>'+r.rows[i].numbercorrect+"/20</b></td>",s+="</tr>";if(r.rows.length<15)for(i=0;i<15;i++)s+='<tr height="40px">',s+='<td style="width: 35%"></td>',s+='<td style="width: 35%"></td>',s+='<td style="width: 35%"></td>',s+="</tr>";r.rows.length<=1?(t+='<div style="text-align: center;">',t+='<h1>&#128373</h1><h4>BEGINNER</h4><br><br><h5 style="text-align: center;">Your Journey is just beginning.<br><br>',t+="Good luck!</h5></div>"):r.rows[r.rows.length-1].improvement>r.rows[r.rows.length-2].improvement?(t+='<div style="text-align: center;"><h1>&#128077;&#127999; &#127942',t+='&#x1F44D</h1><h4>IMPROVER</h4><br><br><h5 style="text-align: center;">Your Memory is Improving. Keep Going!</h5><br></div>'):r.rows[r.rows.length-1].improvement<r.rows[r.rows.length-2].improvement?(t+='<div style="text-align: center;">',t+='<h1>&#128078 &#128530 &#128078;&#127998;</h1><br><h4>POORER</h4><br><br><h5 style="text-align: center;">',t+="Keep playing to improve your memory.</h5><br></div>"):r.rows[r.rows.length-1].improvement<r.rows[r.rows.length-2].improvement&&20==r.rows[r.rows.length-2].improvement?(t+='<div style="text-align: center;">',t+='<h1>&#128580 &#129335 &#128580;</h1><br><h4>STEADY</h4><br><br><h5 style="text-align: center;">',t+="Your Memory has remained consistent.<br><br>Keep Going to Maintain your Memory.</h5><br></div>"):(t+='<div style="text-align: center;">',t+='<h1>&#128580 &#129335 &#128580;</h1><br><h4>STEADY</h4><br><br><h5 style="text-align: center;">',t+="Your Memory has remained consistent.<br><br>Play more to improve further.</h5><br></div>"),o.release(),n.send(`<!DOCTYPE html>\n            <html lang="en">\n            <head>\n                <meta charset="UTF-8">\n                <meta http-equiv="X-UA-Compatible" content="IE=edge">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>Real-Time Quiz App</title>\n                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"\n                crossorigin="anonymous">\n                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"><\/script>\n                <script src="https://kit.fontawesome.com/758fbfa7b4.js" crossorigin="anonymous"><\/script>\n\n                <style>\n\n                body{\n                    background-color:powderblue;\n                }\n\n                p {\n                    text-align: center;   \n                }\n                h5 {\n                    text-align: center;   \n                    color: #34282C; \n                    font-family: Fantasy;\n                }\n\n                h4 {\n                    text-align: center;   \n                }\n\n                th {\n                    text-align: center;\n                }\n\n                .achievements-wrapper { \n                    height: 100%;\n                    width: 100%; \n                    overflow-y: auto;\n                    text-align: center;\n                    position: fixed;\n                }\n\n                 th {\n                    background: white;\n                  }\n\n                .topnav {\n                background-color: #333;\n                overflow: hidden;\n                position: sticky;\n                top: 0px;  \n                }\n\n                .topnav a {\n                float: left;\n                color: #f2f2f2;\n                text-align: center;\n                padding: 24px 5%;\n                text-decoration: none;\n                font-size: 17px;\n                }\n\n                .topnav a.active {\n                background-color: #04AA6D;\n                color: white;\n                }\n\n                .login  {\n                    background-color: black;\n                    color: white;   \n                }\n\n                </style>\n            </head>\n    \n            <body>\n            <div class="topnav">\n            <a href="/" onclick='showHome();' style="width: 100%; background-color: black;"><h2>&#9200 RealTime Quiz</h2></a>\n            <a id="status1" href="#status" onclick='showStatus();' class="active"  style="width: 33%;">Status</a>\n            <a id="history1" href="#history" onclick="showHistory();" style="width: 33%;">Attempts</a>\n            <a id="account1" href="#account" onclick="showAccount();" style="width: 33%;">Account</a>\n        </div>\n        <div id="status">\n        <br>\n                ${t}\n            <form action="/info/get" method="GET">                          \n                <div class="row justify-content-center">\n                    <button type="submit" class="btn btn-primary btn-block" style="padding-top: 15px !important;padding-bottom: 55px !important;font-size: 20pt; width: 100%; height: 10%; position: absolute; bottom:0;">Play the Quiz Now!</button>\n                </div><br>                            \n            </form>\n        </div>\n            \n        <div id="history" class="span3 achievements-wrapper" style="display:none;">\n            <table class="table table-striped table-light">\n                <tbody>\n                    ${s}\n                </tbody>\n            </table>\n         </div>\n\n         <div id="account" style="text-align:center; display: none;"><br>\n         <h6 style="text-align: center;">${nickName}<br>Account Area </h6>\n\n         <div class="row justify-content-center" id="typeuser">\n \n         <form action="/change/user" method="POST">\n             <div>\n             <div>\n             <label for="nickname" id="manynickname" style="color: red; display: none; margin-bottom: -10px;"><b>Max 14 Name Characters</b></label>\n             </div>\n             <input type="text" name="nickname" id="nickname" maxlength="14" placeholder='Enter New Username' style="margin-left: 10px font-size: 6pt; height: 28px; width:260px;margin-top: 5%; text-align: center;" required><br> \n             <div>\n             <label for="password" id="manypassword" style="color: red;display: none;"><b>Max 20 Password Characters</b></label>\n             <div>\n             <input type="password" name="password" id="password" maxlength="20" placeholder='Enter Your Password' style="margin-left: 5px font-size: 6pt; height: 28px; width:260px;margin-top: 5%;text-align: center;" required><br>\n             \n             <div style="width:250px;" align="center">\n                 <button type="submit" class="btn btn-block login" style="font-size: 12pt; width:260px; height: 38px;margin-top: 5%;">Update Username</button>\n             </div>                  \n         </form>\n     </div>\n\n     <div class="row justify-content-center" id="typepassword" style="padding-top: 2%;">\n \n         <form action="/change/password" method="POST">\n             <div>\n             <div>\n             <label for="password" id="manypassword" style="color: red;text-align: center; display: none;"><b>Max 20 Password Characters</b></label>\n             <div>\n             <input type="password" name="newpassword" id="newpassword" maxlength="20" placeholder='Enter New Password' style="margin-left: 5px font-size: 6pt; height: 28px; width:260px;margin-top: 5%;text-align: center;" required><br>\n             <input type="password" name="password" id="password" maxlength="20" placeholder='Enter Old Password' style="margin-left: 5px font-size: 6pt; height: 28px; width:260px;margin-top: 5%;text-align: center;" required><br>\n             \n             <div style="width:250px;" align="center">\n                 <button type="submit" class="btn btn-block login" style="font-size: 12pt; width:260px; height: 38px;margin-top: 5%;">Update Password</button>\n             </div><br>                   \n         </form>\n     </div>\n     </div>\n     <script>\n            var $input = $('input')\n                $input.keyup(function(e) {\n                    var max = 40;\n                    if ($input.val().length > max) {\n                        $input.val($input.val().substr(0, max));\n                    }\n                });\n\n            $("#email").on('input', function() {\n            if ($(this).val().length >= 40) {\n                document.getElementById("manyemail").style.display = "block";\n            } else{\n                document.getElementById("manyemail").style.display = "none";\n            }\n            });\n\n            $("#password").on('input', function() {\n            if ($(this).val().length >= 20) {\n                document.getElementById("manypassword").style.display = "block";\n            } else{\n                document.getElementById("manypassword").style.display = "none";\n            }\n            });\n\n            $("#nickname").on('input', function() {\n            if ($(this).val().length >= 14) {\n                document.getElementById("manynickname").style.display = "block";\n            } else{\n                document.getElementById("manynickname").style.display = "none";\n            }\n            });\n\n            function showStatus(){\n                document.getElementById("status").style.display = "block";\n                document.getElementById("status1").className = "active";\n                document.getElementById("history").style.display = "none";\n                document.getElementById("history1").className = "";\n                document.getElementById("account").style.display = "none";\n                document.getElementById("account1").className = "";\n            }\n            function showHistory(){\n                document.getElementById("status").style.display = "none";\n                document.getElementById("status1").className = "";\n                document.getElementById("history").style.display = "block";\n                document.getElementById("history1").className = "active";\n                document.getElementById("account").style.display = "none";\n                document.getElementById("account1").className = "";\n            }\n            function showAccount(){\n                document.getElementById("status").style.display = "none";\n                document.getElementById("status1").className = "";\n                document.getElementById("history").style.display = "none";\n                document.getElementById("history1").className = "";\n                document.getElementById("account").style.display = "block";\n                document.getElementById("account1").className = "active";\n            }\n        <\/script>         \n        </body>\n        </html>`)})}catch(e){console.log(e)}}),app.post("/change/user",(e,n)=>{try{pool.connect(async(t,o,a)=>{let r=await o.query("select * from users");var s=0;for(i=0;i<r.rows.length;i++)r.rows[i].name==nickName&&r.rows[i].password==e.body.password&&s++;if(1==s){await o.query(`UPDATE users SET name = '${e.body.nickname}' WHERE name = '${nickName}'`),await o.query(`UPDATE leaderboard SET nickname = '${e.body.nickname}' WHERE nickname = '${nickName}'`);newdetails=!0,n.redirect("/")}else userpass=!0,n.redirect("/");o.release()}),newdetails=!1}catch(e){console.log(e)}}),app.post("/change/password",(e,n)=>{try{pool.connect(async(t,o,a)=>{let r=await o.query("select * from users");var s=0;for(i=0;i<r.rows.length;i++)r.rows[i].name==nickName&&r.rows[i].password==e.body.password&&s++;if(1==s){await o.query(`UPDATE users SET password = '${e.body.newpassword}' WHERE name = '${nickName}'`);o.release(),newdetails=!0,n.redirect("/")}else o.release(),passpass=!0,n.redirect("/")}),newdetails=!1}catch(e){console.log(e)}}),app.get("/info/get",(e,n)=>{list=[],firstchoice=[],correctchoice=[],secondchoice=[];try{pool.connect(async(e,o,a)=>{let r=await o.query("SELECT * FROM questions"),s=[];for(i=0;i<20;i++)x=Math.floor(1200*Math.random())+1,s.push(x),list.push(r.rows[x].question);for(i=0;i<20;i++)firstchoice.push(r.rows[s[i]].option1);for(i=0;i<20;i++)secondchoice.push(r.rows[s[i]].option2);for(i=0;i<20;i++)correctchoice.push(r.rows[s[i]].correctanswer);var l="";for(i=0;i<list.length;i++)for(arr=[],t=0;t<1;t++)arr.push(correctchoice[i]),l+=`<div id=${i} class="my-container" style="margin-left: -3.2em; margin-right: -1.2em; display:none">`,l+=`<h4 style="margin-left: 1.2em;">Question ${i+1}<br></h4><p style="font-size: 20px;margin-left: 1.4em;">${list[i]}</p>`+"<br>",l+=`<label class="container"><h5 style="margin-left: -0.8em;">Answer: ${arr[0]}</h5>\n                </label><br>`,l+=`<a href="#" onclick="fastForward(${i})">><h4 style="margin-left: 1.2em;">Next >>></h4></a>`,l+="</div>";var c="";for(i=0;i<20;i++)for(arr2=[],t=0;t<1;t++)arr2.push(firstchoice[i]),arr2.push(secondchoice[i]),arr2.push(correctchoice[i]),shuffle(arr2),c+=`<div id=${21+i} class="my-container" style="margin-left: -3.2em; margin-right: -1.2em; display:none">`,c+=`<h4 style="margin-left: 1.2em;">Question ${i+1}</h4><p style="font-size: 20px;margin-left: 1.4em;">${list[i]}</p>`+"<br>",c+=`<label class="container" style="margin-left: 1.8em;"><p>${arr2[0]}</p>\n                <input type="checkbox" id="checkvalue2" name="option" value='${arr2[0]}' onclick="seeNext(${21+i});">\n                <span class="checkmark"></span>\n                </label>`,c+=`<label class="container" style="margin-left: 1.8em;"><p>${arr2[1]}</p>\n                <input type="checkbox"  id="checkvalue2" name="option" value='${arr2[1]}' onclick="seeNext(${21+i});">\n                <span class="checkmark"></span>\n                </label>`,c+=`<label class="container" style="margin-left: 1.8em;"><hp>${arr2[2]}</hp>\n                <input type="checkbox"  id="checkvalue2" name="option" value='${arr2[2]}' onclick="seeNext(${21+i});">\n                <span class="checkmark"></span>\n                </label>`,c+="</div>";o.release(),n.send(`<!DOCTYPE html>\n        <html lang="en">\n        <head>\n            <meta charset="UTF-8">\n            <meta http-equiv="X-UA-Compatible" content="IE=edge">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>Document</title>\n            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"\n            crossorigin="anonymous">\n            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"><\/script>\n            <script>\n            $('.container').click(function() {\n                $("#checkvalue").prop("checked", true);\n              });\n            <\/script>\n\n            <style>\n              \n            body {\n                background-color:powderblue;\n            }\n\n            .my-container {\n                height: 340px;\n                justify-content: space-around;\n                margin: 20px 0px 0px 20px;\n            }\n\n            .container {\n                display: block;\n                position: relative;\n                padding-left: 50px;\n                padding-right: 50px;\n                margin-bottom: 18px;\n                width: 100%;\n                cursor: pointer;\n                font-size: 18px;\n                -webkit-user-select: none;\n                -moz-user-select: none;\n                -ms-user-select: none;\n                user-select: none;\n                margin: 10px 20px 20px -5px;\n              }\n            \n            .container input {\n              position: absolute;\n              opacity: 0;\n              cursor: pointer;\n              height: 0;\n              width: 0;\n            }\n            \n            .checkmark {\n              position: absolute;\n              top: 0;\n              left: 0;\n              height: 25px;\n              width: 25px;\n              background-color: grey;\n            }\n            \n            .container:hover input ~ .checkmark {\n              background-color: #ccc;\n            }\n            \n            .container input:checked ~ .checkmark {\n              background-color: #2196F3;\n            }\n            \n            .checkmark:after {\n              content: "";\n              position: absolute;\n              display: none;\n            }\n            \n            .container input:checked ~ .checkmark:after {\n              display: block;\n            }\n            \n            .container .checkmark:after {\n              left: 9px;\n              top: 5px;\n              width: 5px;\n              height: 10px;\n              border: solid white;\n              border-width: 0 3px 3px 0;\n              -webkit-transform: rotate(45deg);\n              -ms-transform: rotate(45deg);\n              transform: rotate(45deg);\n            }\n\n            .jumbotron {\n                height: 40px;\n                padding-top: 25px !important;\n                padding-bottom: 75px !important;\n                margin: 0px 15px 30px 30px;\n            }\n\n            button {\n                height: 50px;\n                width: 290px;\n                margin-top: 5%;\n            }\n\n            h2 {\n                margin-left: 20%;\n            }\n            #myProgress {\n                width: 100%;\n                background-color: #ddd;\n                vertical-align:middle;\n                \n              }\n              \n            #myBar {\n                width: 0%;\n                height: 40px;\n                background-color: #04AA6D;\n                text-align: center;\n                vertical-align: middle;\n                line-height: 35px;\n                font-size: 25px;\n                color: white;\n              }\n                    .topnav {\n                    background-color: #333;\n                    overflow: hidden;\n                    }\n\n                    .topnav a {\n                    float: left;\n                    color: #f2f2f2;\n                    text-align: center;\n                    padding: 24px 5%;\n                    text-decoration: none;\n                    font-size: 17px;\n                    }\n\n                    /* Add a color to the active/current link */\n                    .topnav a.active {\n                    background-color: #04AA6D;\n                    color: white;\n                    }\n            </style>\n        </head>\n        <body>\n        <div class="topnav">\n        <a href="/" onclick='showHome();' style="width: 100%; background-color: black;"><h1>&#9200 RealTime Quiz</h1></a>\n        \n        </div>\n                <div id="myProgress">\n                <div id="myBar"></div>\n             </div>\n            <div id="checkvalue" class="container" style="width: 100%;">\n            \n            <form>\n                <div id="form"><p style="color:purple;margin-left: -1.4em;"><b> Disappears in <span id="countdowntimer">5 </span> seconds</b></p>${l}</div>\n                <div id="form2"><p style="color:purple;margin-left: -1.4em;display:none;"><b> Question Disappears in <span id="countdowntimer2">5 </span> Seconds</b></p></div>\n            </form>\n            </div>\n\n            <div id="checkvalue2" class="container" ">\n            \n            <form action="/answers" method="POST">\n            \n            <div id="form">${c}</div>\n\n            <div id="button2" style="display: none;"><br><br>\n                <label for="answers"><h4>Press Button to See Results</h4></label><br>\n                <button type="submit" id="answers" class="btn btn-primary btn-lg">Submit Answers</button>\n            </div>\n            </form>\n            </div>\n            <div id="button" style="display: none;margin-left: 5%;"><br><br>\n                 \n                    <label for="answers"><h4>Push Button Below to Begin</h4></label><br>\n                    <button id="answers" class="btn btn-primary btn-lg" onclick="seeFirstofAll(21);">See the Questions</button>\n                \n                </div>\n            <script>\n            var width = 0;\n            var length = 0;\n            let downloadTimer;\n            let downloadTimer2;\n            let myTimeOut;\n            let myTimeOut2;\n            let timeleft = 5;\n\n            function getQuestion(number) {\n                myTimeOut = setTimeout(function(){\n                    if (number != 19){\n                        clearInterval(downloadTimer);\n                        notnext = document.getElementById(number);\n                        notnext.style.display = "none";\n                        nextNumber = number + 1;\n                        passnext = document.getElementById(nextNumber);\n                        passnext.style.display = "block";   \n                        nobutton = document.getElementById("button");\n                        nobutton.style.display = "none";   \n                        var elem = document.getElementById("myBar");\n                        width += 5;\n                        elem.style.width = width + "%";\n                        elem.innerHTML = width + "%";\n                        timeleft = 5;\n                        timer(nextNumber);\n                    }\n                   \n                }, 100);\n            }\n\n            function fastForward(number){\n                timeleft = 0;\n                console.log("fastForward")\n                console.log(number);\n                clearTimeout(myTimeOut);\n                if (number < 19){\n                    getQuestion(number);\n                } else{\n                    notnext = document.getElementById(number);\n                    notnext.style.display = "none";\n                    passnext = document.getElementById("button");\n                    passnext.style.display = "block";  \n                    document.getElementById("form").style.display = "none"; \n                }\n                        \n            }\n\n            var size = document.getElementById("checkvalue");\n            for(i=0; i<size.innerHTML.length; i++){\n                if(i==0){\n                    document.getElementById("button").style.display = "none";\n                    document.getElementById(0).style.display = "block";\n                    var elem = document.getElementById("myBar");\n                    var width = 5;\n                    elem.style.width = width + "%";\n                    elem.innerHTML = width +  "%";\n                    timer(0);\n                } else{\n                    document.getElementById(i).style.display = "none";\n                }\n            }        \n            async function timer(number){\n                clearTimeout(myTimeOut);\n                console.log("timer started");\n                downloadTimer = setInterval(function(){\n                document.getElementById("countdowntimer").textContent = timeleft;\n                if(number != 30 && timeleft == 0){\n                    clearInterval(downloadTimer);\n                    fastForward(number);\n                } \n                timeleft -= 1;\n            }, 1500);   \n            }   \n\n            async function seeFirstofAll(digit){\n                document.getElementById("button").style.display = "none";\n                seeFirst(digit);\n            }\n            function seeFirst(digit){\n                if (digit == 21){\n                    console.log("seeFirst digit is" + digit);\n                    document.getElementById(digit).style.display = "block";\n                    var elem = document.getElementById("myBar");\n                    width = 5;\n                    elem.style.width = width + "%";\n                    elem.innerHTML = width + "%";\n                    console.log("seeFirst != 40");\n                } \n            }\n\n            function seeNext(digit){\n                setTimeout(function(){\n                    if (digit != 40) {\n                        document.getElementById(digit).style.display = "none";\n                        passnext = document.getElementById("button");\n                        passnext.style.display = "none";  \n                        document.getElementById(digit+1).style.display = "block";\n                        var elem = document.getElementById("myBar");\n                        width += 5;\n                        elem.style.width = width + "%";\n                        elem.innerHTML = width + "%";\n                        console.log("seeNext != 40");\n                    } else if (digit == 40){\n                        document.getElementById(digit).style.display = "none";\n                        document.getElementById("button2").style.display = "block";\n                        width += 10;\n                        console.log("seeNext == 40");\n                    }\n                }, 100);\n            }\n                <\/script>\n        </body>\n        </html>`)})}catch(e){console.log(e)}}),app.post("/answers",async(e,n)=>{var t="";const o=e.body.option;if(1==e.body.option[0].length){for(i=0;i<e.body.option.length;i++)t+=e.body.option[i];userChoice.push(t)}else for(i=0;i<o.length;i++)userChoice.push(o[i]);var a,r=[];for(i=0;i<userChoice.length;i++)for(p=0;p<correctchoice.length;p++)userChoice[i]==correctchoice[p]&&r.push(userChoice[i]);a=r.length;var s="";for(i=0;i<userChoice.length;i++)s+="<br>",s+='<hr style="height:1px;border:none;color:#333;background-color:#333;">',s+='<div class="my-container" style="margin-left: -10px;">',s+=`<h3 style="margin-left: -10px;">Question ${i+1}</h3>`,s+=`<h4 style="margin-left: -10px;">${list[i]}</h4>`+"<br>",userChoice[i]==correctchoice[i]?(s+='<h3 style="margin-left: -10px; color:green;">CORRECT</h3>',s+=`<label class="container" style="margin-left: -10px;">${firstchoice[i]}\n            <input type="checkbox" id="correct1" name="option" value='${firstchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+=`<label class="container" style="margin-left: -10px;">${secondchoice[i]}\n            <input type="checkbox"  id="correct2" name="option" value='${secondchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+=`<label class="container" style="margin-left: -10px;">${correctchoice[i]}\n            <input type="checkbox" checked="checked"  id="correct3" name="option" value='${correctchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+="<br></div>"):userChoice[i]==firstchoice[i]?(s+='<h3 style="margin-left: -10px;color:red;">INCORRECT</h3>',s+=`<label class="container2" style="margin-left: -10px;">${firstchoice[i]}\n            <input type="checkbox" checked="checked" id="incorrect1" name="option" value='${firstchoice[i]}'>\n            <span class="checkmark2"></span>\n            </label>`,s+=`<label class="container" style="margin-left: -10px;">${secondchoice[i]}\n            <input type="checkbox"  id="incorrect2" name="option" value='${secondchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+=`<label class="container" style="margin-left: -10px;">${correctchoice[i]}\n            <input type="checkbox" checked="checked" id="incorrect3" name="option" value='${correctchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+="</div>"):(s+='<h3 style="margin-left: -10px; color:red;">INCORRECT</h3>',s+=`<label class="container" style="margin-left: -10px;"">${firstchoice[i]}\n            <input type="checkbox" id="incorrect1" name="option" value='${firstchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+=`<label class="container2" style="margin-left: -10px;">${secondchoice[i]}\n            <input type="checkbox" checked="checked" id="incorrect2" name="option" value='${secondchoice[i]}'>\n            <span class="checkmark2"></span>\n            </label>`,s+=`<label class="container" style="margin-left: -10px;">${correctchoice[i]}\n            <input type="checkbox" checked="checked" id="incorrect3" name="option" value='${correctchoice[i]}'>\n            <span class="checkmark"></span>\n            </label>`,s+="</div>");try{pool.connect(async(e,t,o)=>{let i=await t.query(`select * from leaderboard where \n            leaderboard.nickname = '${nickName}'`);var r=0,l=0,c=0;i.rows.length<1?(userAttempt=1,c=0):(userAttempt=i.rows.length+1,r=i.rows[0].numbercorrect,l=a-r,c=Math.round(l/r*100));await t.query("insert into leaderboard (attemptnumber, nickname, date, numbercorrect, improvement) values ($1, $2, $3, $4, $5)",[userAttempt,nickName,userDate,a,c]);t.release(),n.send(`<!DOCTYPE html>\n            <html lang="en">\n            <head>\n                <meta charset="UTF-8">\n                <meta http-equiv="X-UA-Compatible" content="IE=edge">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>Real-Time Quiz App</title>\n                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"\n                crossorigin="anonymous">\n                <style>\n                body{\n                    background-color:powderblue;\n                }\n                h1 {\n                    text-align: center;    \n                    padding-top: 15px !important;\n                }\n\n                th {\n                    text-align: center;\n                }\n\n                .my-container {\n                    height: 440px;\n                    justify-content: space-around;\n                    margin: 20px 0px 0px 20px;\n                }\n    \n                .container {\n                  display: block;\n                  position: relative;\n                  padding-left: 50px;\n                  padding-right: -50px;\n                  margin-bottom: 18px;\n                  cursor: pointer;\n                  font-size: 22px;\n                  -webkit-user-select: none;\n                  -moz-user-select: none;\n                  -ms-user-select: none;\n                  user-select: none;\n                  margin: 20px -20px 20px 20px;\n                }\n                \n                .container input {\n                  position: absolute;\n                  opacity: 0;\n                  cursor: pointer;\n                  height: 0;\n                  width: 0;\n                }\n                \n                .checkmark {\n                  position: absolute;\n                  top: 0;\n                  left: 0;\n                  height: 25px;\n                  width: 25px;\n                  background-color: grey;\n                  \n                }\n                \n                .container:hover input ~ .checkmark {\n                  background-color: #ccc;\n                }\n                \n                .container input:checked ~ .checkmark {\n                  background-color: green;\n                }\n                \n                .checkmark:after {\n                  content: "";\n                  position: absolute;\n                  display: none;\n                }\n                \n                .container input:checked ~ .checkmark:after {\n                  display: block;\n                }\n                \n                .container .checkmark:after {\n                  left: 9px;\n                  top: 5px;\n                  width: 5px;\n                  height: 10px;\n                  border: solid white;\n                  border-width: 0 3px 3px 0;\n                  -webkit-transform: rotate(45deg);\n                  -ms-transform: rotate(45deg);\n                  transform: rotate(45deg);\n                }\n    \n                .container2 {\n                    display: block;\n                    position: relative;\n                    padding-left: 65px;\n                    margin-bottom: -18px;\n                    cursor: pointer;\n                    font-size: 22px;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n                    user-select: none;\n                    margin: 20px -20px 20px 20px;\n                  }\n       \n                  .container2 input {\n                    position: absolute;\n                    opacity: 0;\n                    cursor: pointer;\n                    height: 0;\n                    width: 0;\n                  }\n                  \n                  .checkmark2 {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    height: 25px;\n                    width: 25px;\n                    background-color: grey;\n                    \n                  }\n                  \n                  .container2:hover input ~ .checkmark2 {\n                    background-color: #ccc;\n                  }\n                  \n                  .container2 input:checked ~ .checkmark2 {\n                    background-color: red;\n                  }\n                  \n                  .checkmark2:after {\n                    content: "";\n                    position: absolute;\n                    display: none;\n                  }\n                  \n                  .container2 input:checked ~ .checkmark2:after {\n                    display: block;\n                  }\n                  .container2 .checkmark2:after {\n                    left: 9px;\n                    top: 5px;\n                    width: 5px;\n                    height: 10px;\n                    border: solid white;\n                    border-width: 0 3px 3px 0;\n                    -webkit-transform: rotate(45deg);\n                    -ms-transform: rotate(45deg);\n                    transform: rotate(45deg);\n                  }\n                \n                .jumbotron {\n                    height: 100px;\n                    padding-top: 15px !important;\n                    padding-bottom: 105px !important;\n                }\n                .achievements-wrapper { \n                    height: 310px; \n                    overflow: auto; \n                }\n\n                 th {\n                    position: sticky;\n                    top: 0px;  \n                    background: black;\n                  }\n                  button {\n                    height: 30px;\n                    padding-top: 15px !important;\n                    padding-bottom: 55px !important;\n                }\n              .topnav {\n              background-color: #333;\n              overflow: hidden;\n              }\n              .topnav a {\n              float: left;\n              color: #f2f2f2;\n              text-align: center;\n              padding: 24px 5%;\n              text-decoration: none;\n              font-size: 17px;\n              }\n\n              .topnav a.active {\n              background-color: #04AA6D;\n              color: white;\n              }\n                </style>\n            </head>\n            <body>\n            <div class="topnav">\n                    <a href="/" onclick='showHome();' style="width: 100%; background-color: black;"><h1>&#9200 RealTime Quiz</h1></a></div>\n            <div id="showincorrect" class="container" style="display:none;">\n            ${s}\n            <form action="/user/profile" method="GET">\n                <button type="submit" class="btn btn-primary btn-lg btn-block" style="margin-bottom: 180px;">Back To Profile</button>\n                </form>  \n            </div>\n            <div id="takesurvey" class="row justify-content-center" style="display: none;text-align: center;">\n            <div>\n            <h2 style="text-align: center;">Questionnaire</h2></div><br>\n            <form action="/survey" method="POST">\n            <h6 id="question1" style="text-align: center;">How often have you played the quiz?</h6>\n            <input type="radio" id="howoften" name="howoften" value="very often" required>\n            <label for="howoften">Very Often</label>\n            <input type="radio" id="howoften" name="howoften" value="often">\n            <label for="howoften">Often</label>\n            <input type="radio" id="howoften" name="howoften" value="occasionally">\n            <label for="howoften">Occasionally</label>\n            <input type="radio" id="howoften" name="howoften" value="rarely">\n            <label for="howoften">Rarely</label><br><br>\n            <h6 id="question2" style="text-align: center;">Have you used all the app's features?</h6>\n            <input type="radio" id="usedfeatures" name="usedfeatures" value="yes" required>\n            <label for="usedfeatures">Yes</label>\n            <input type="radio" id="usedfeatures" name="usedfeatures" value="no">\n            <label for="usedfeatures">No</label><br><br>\n            <h6 id="question3" style="text-align: center;">Do you think this app will improve memory?</h6>\n            <input type="radio" id="willimprove" name="willimprove" value="yes" required>\n            <label for="willimprove">Yes</label>\n            <input type="radio" id="willimprove" name="willimprove" value="no">\n            <label for="willimprove">No</label><br><br>\n            <h6 id="question4" style="text-align: center;">How old are you?</h6>\n            <input type="radio" id="howold" name="howold" value="18 to 40" required>\n            <label for="howold">18 to 40</label>\n            <input type="radio" id="howold" name="howold" value="40 to 65">\n            <label for="howold">40 to 65</label>\n            <input type="radio" id="howold" name="howold" value="over 65">\n            <label for="howold">Over 65</label><br><br>\n            <h6 id="question5" style="text-align: center;">Is the app easy to use?</h6>\n            <input type="radio" id="easyuse" name="easyuse" value="yes" required>\n            <label for="easyuse">Yes</label>\n            <input type="radio" id="easyuse" name="easyuse" value="no">\n            <label for="easyuse">No</label><br><br>\n            <h6 id="question6" style="text-align: center;">Is logging in easy to do?</h6>\n            <input type="radio" id="logeasy" name="logeasy" value="yes" required>\n            <label for="logeasy">Yes</label>\n            <input type="radio" id="logeasy" name="logeasy" value="no">\n            <label for="logeasy">No</label><br><br>\n            <h6 id="question7" style="text-align: center;">Have you noticed any issues like time-lag?</h6>\n            <input type="radio" id="timelag" name="timelag" value="yes" required>\n            <label for="timelag">Yes</label>\n            <input type="radio" id="timelag" name="timelag" value="no">\n            <label for="timelag">No</label><br><br>\n            <label for="explain"><h6 id="question8">How could the app be improved?</h6></label><br>\n            <textarea id="explain" name="explain" rows="3" cols="40" required>\n            </textarea><br><br>\n            <button type="submit" class="btn btn-dark btn-block" style="font-size: 18pt; width:60%;margin-left:20%;">Submit Survey</button><br>\n          </form>\n            </div><br>\n\n            <div id="showscore" class="row justify-content-center">\n                <h3>Your Score is ${a} out of 20</h3>\n            </div><br>\n            \n            <div id="seebreakdown" class="row justify-content-center">\n                <button class="btn btn-dark btn-block" onclick="incorrect()" style="font-size: 18pt; width:260px;">See Breakdown</button>\n            </div><br>\n\n            <div id="backprofile" class="row justify-content-center">\n            <form action="/user/profile" method="GET">\n                <button type="submit" class="btn btn-dark btn-block" style="font-size: 18pt; width:260px;">Back to Profile</button>         \n            </form>  \n            </div><br>\n\n            <div id="showsurvey" class="row justify-content-center">\n            <div class="text-center">\n                <button type="submit" class="btn btn-dark btn-block" onclick="survey();" style="font-size: 18pt; width:260px;">\n                Complete Survey</button>\n            </div>   \n            </div>\n            <script>\n            function survey(){\n                document.getElementById("showscore").style.display = "none";\n                document.getElementById("seebreakdown").style.display = "none";\n                document.getElementById("backprofile").style.display = "none";\n                document.getElementById("showsurvey").style.display = "none";\n                document.getElementById("takesurvey").style.display = "block";\n            }\n            function incorrect(){\n                document.getElementById("showscore").style.display = "none";\n                document.getElementById("seebreakdown").style.display = "none";\n                document.getElementById("backprofile").style.display = "none";\n                document.getElementById("showsurvey").style.display = "none";\n                document.getElementById("takesurvey").style.display = "none";\n                document.getElementById("showincorrect").style.display = "block";\n            }\n            <\/script>\n            </body>\n            </html>`)})}catch(e){console.log(e)}}),app.post("/survey",async(e,n)=>{var t=nodemailer.createTransport({service:"outlook",auth:{user:"real_time_quiz@outlook.com",pass:"Realtimequiz"}}),o={from:"real_time_quiz@outlook.com",to:"cy1yates@gmail.com",subject:"RealTime Quiz Survey",html:`\n            <table style="width:100%; border: 1px solid black;">\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">How often have you played the quiz?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.howoften}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">Have you used all the app's features?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.usedfeatures}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">Do you think this app will improve memory?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.willimprove}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">How old are you?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.howold}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">Is the app easy to use?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.easyuse}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">Is logging in easy to do?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.logeasy}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">Have you noticed any issues like time-lag?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.timelag}</td>\n            </tr>\n            <tr>\n              <td style="border: 1px solid black; width: 50%;">How could the app be improved?</td>\n              <td style="border: 1px solid black;width: 50%;text-align: center;">${e.body.explain}</td>\n            </tr>\n          </table>\n            `};t.sendMail(o,function(e,n){e&&console.log(e)}),n.redirect("/user/profile")}),server.listen(process.env.PORT||8080),console.log("Server listening on Port 8080 ");